# -*- coding: utf-8 -*-
"""Day 4 ML project wine quality prediction.ipynb.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1NV2J2nK5qdw8IUlzGjvMrjZQtSsgGKlp
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

df = pd.read_csv('/content/drive/MyDrive/wine.csv')

df.head()

df=df.replace("good",1)
df=df.replace("bad",0)

df.head()

df.info()

df.describe()

df.isnull().sum()

fig = plt.figure(figsize=(10,6))
sns.barplot(x= 'quality', y='fixed acidity', data = df)

fig = plt.figure(figsize=(10,6))
sns.barplot(x= 'quality', y='volatile acidity', data = df)

fig = plt.figure(figsize=(10,6))
sns.barplot(x= 'quality', y='citric acid', data = df)

fig = plt.figure(figsize=(10,6))
sns.barplot(x= 'quality', y='residual sugar', data = df)

fig = plt.figure(figsize=(10,6))
sns.barplot(x= 'quality', y='chlorides', data = df)

fig = plt.figure(figsize=(10,6))
sns.barplot(x= 'quality', y='free sulfur dioxide', data = df)

sns.countplot(df['quality'])

from sklearn.model_selection import train_test_split
X = df.drop('quality', axis=1).values
y = df['quality'].values
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

from sklearn.ensemble import RandomForestClassifier

model = RandomForestClassifier(criterion = "gini", n_estimators=90)
model.fit(X_train, y_train)

model.score(X_test,y_test)